III. C·∫•u h√¨nh Kafka cho System Engineer
1. C·∫•u h√¨nh c∆° b·∫£n:

File c·∫•u h√¨nh ch√≠nh:
/opt/kafka/config/server.properties

C√°c th√¥ng s·ªë quan tr·ªçng:

broker.id=1                     # ID duy nh·∫•t cho m·ªói broker
listeners=PLAINTEXT://:9092     # Giao th·ª©c v√† port Kafka l·∫Øng nghe
log.dirs=/var/lib/kafka/data    # Th∆∞ m·ª•c l∆∞u d·ªØ li·ªáu
zookeeper.connect=localhost:2181  # N·∫øu d√πng ZooKeeper mode
num.partitions=3
default.replication.factor=2

2. C·∫•u h√¨nh cho High Availability (HA):

Cluster t·ªëi thi·ªÉu 3 broker

replication.factor >= 3

min.insync.replicas=2 ƒë·ªÉ tr√°nh m·∫•t d·ªØ li·ªáu

unclean.leader.election.enable=false ƒë·ªÉ ch·ªâ cho ph√©p leader c√≥ d·ªØ li·ªáu m·ªõi nh·∫•t

3. Security

B·∫≠t SSL / SASL:

listeners=SASL_SSL://:9093
security.inter.broker.protocol=SASL_SSL
sasl.mechanism.inter.broker.protocol=SCRAM-SHA-512


ACL qu·∫£n l√Ω quy·ªÅn publish / consume:

kafka-acls.sh --add --allow-principal User:app --operation Read --topic mytopic

üß∞ IV. Tri·ªÉn khai Kafka th·ª±c t·∫ø
1. C√†i ƒë·∫∑t (ƒë∆°n gi·∫£n nh·∫•t):
wget https://downloads.apache.org/kafka/3.7.0/kafka_2.13-3.7.0.tgz
tar -xzf kafka_2.13-3.7.0.tgz
cd kafka_2.13-3.7.0

2. Kh·ªüi ƒë·ªông d·ªãch v·ª•:
# Start ZooKeeper (n·∫øu d√πng)
bin/zookeeper-server-start.sh config/zookeeper.properties

# Start Kafka
bin/kafka-server-start.sh config/server.properties

3. T·∫°o topic, g·ª≠i & nh·∫≠n message:
bin/kafka-topics.sh --create --topic demo --bootstrap-server localhost:9092 --partitions 3 --replication-factor 1
bin/kafka-console-producer.sh --topic demo --bootstrap-server localhost:9092
bin/kafka-console-consumer.sh --topic demo --bootstrap-server localhost:9092 --from-beginning

üõ†Ô∏è V. Gi√°m s√°t & B·∫£o tr√¨
1. Monitoring metrics:

JVM heap / GC time

Lag gi·ªØa Producer v√† Consumer

Disk I/O, network latency

Topic throughput (messages/sec)

C√¥ng c·ª• ph·ªï bi·∫øn:

Prometheus + Grafana (Kafka Exporter)

Confluent Control Center

LinkedIn Burrow (consumer lag monitoring)

2. Log location:

/opt/kafka/logs/server.log

/var/log/kafka/ (n·∫øu ch·∫°y service)

Theo d√µi:

journalctl -u kafka
tail -f /opt/kafka/logs/server.log

3. C·∫•u h√¨nh retention:

Gi·ªõi h·∫°n d·ªØ li·ªáu c≈©:

log.retention.hours=168     # Gi·ªØ d·ªØ li·ªáu 7 ng√†y
log.segment.bytes=1073741824  # 1 GB m·ªói segment
